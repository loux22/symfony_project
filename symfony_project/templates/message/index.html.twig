{% extends 'base.html.twig' %}

{% block title %}Hello MessageController!{% endblock %}

{% block stylesheets %}
<!--===============================================================================================-->
<link rel="icon" type="image/png" href="{{ asset('images/icons/favicon.ico') }}" />
<!--===============================================================================================-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<!--===============================================================================================-->
<link href="{{ asset('vendor/fontawesome-free/css/all.min.css') }}" rel="stylesheet" type="text/css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="{{ asset('css/main.css') }}">
{% endblock %}

{% block body %}

<div class="container-login100" style="background-image: url('{{ asset('images/bg-01.jpg') }}');">
    <!-- <div class="container py-5 px-4"> -->
    <div class="row rounded-lg overflow-hidden shadow d-flex justify-content-center">
        <!-- Users box-->
        <div class="px-0" style="max-width: 500px;">
            <div class="bg-white">

                <div class="bg-gray px-4 py-2 bg-light d-flex justify-content-between">
                    <a type="button" class="btn btn-danger" href="{{ path('seeGroups') }}"><i
                            class="fas fa-arrow-left"></i></a>
                    <p class="h5 mb-0 py-1">{{ groupe.nom }}</p>

                </div>

                <div class="px-4 py-5 chat-box bg-white" style="max-height: 65vh; overflow-y: scroll;">
                    {% for message in messages %}

                    {% if app.user == message.user %}

                    <!-- Reciever Message-->
                    <!-- la classe ml-auto place le message de la personne qui envoie Ã  droite  -->
                    <div class="media w-50 ml-auto mb-3">
                        <div class="media-body">
                            <div class="bg-primary rounded py-2 px-3 mb-2">
                                <p class="text-small mb-0 text-white">{{ message.content }}</p>
                            </div>
                            <p class="small text-muted">{{ message.date.date }}</p>
                        </div>
                    </div>

                    {% else %}
                    <!-- Sender Message-->
                    <div class="media w-50 mb-3"><img src="{{ asset("images/upload/" ~ message.user.photo) }}"
                            alt="user" width="50" class="rounded-circle">
                        <div class="media-body ml-3">
                            <div class="bg-light rounded py-2 px-3 mb-2">
                                <p class="text-small mb-0 text-muted">{{ message.content }}</p>
                            </div>
                            <p class="small text-muted">{{ message.date.date }}</p>
                        </div>
                    </div>
                    {% endif %}

                    {% endfor %}

                    <!-- Typing area -->
                    {{form_start(messageForm)}}

                    <!-- <form action="#" class="bg-light"> -->
                    <div class="input-group">
                        {{ form_widget(messageForm.content) }}
                        <!-- <input type="text" placeholder="Type a message" aria-describedby="button-addon2"
                        class="form-control rounded-0 border-0 py-4 bg-light"> -->
                        <div class="input-group-append">
                            <!-- <button id="button-addon2" type="submit" class="btn btn-link"> <i
                                class="fa fa-paper-plane"></i></button> -->
                            {{ form_widget(messageForm.envoyer) }}
                        </div>
                    </div>
                    <!-- </form> -->
                    {{form_end(messageForm)}}

                </div>
            </div>

        </div>

        <div>

        </div>

        <script>
            document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
        </script>
        {% endblock %}